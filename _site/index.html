<!doctype html>
<!--[if IE 7]>         <html class="lt-ie10 lt-ie9 lt-ie8" > <![endif]-->
<!--[if IE 8]>         <html class="lt-ie10 lt-ie9" > <![endif]-->
<!--[if IE 9]>         <html class="lt-ie10" > <![endif]-->
<!--[if gt IE 9]><!--> <html lang="en" > <!--<![endif]-->
<head>
    <title>Sky Analytics API Demo Page</title>

    <link rel="stylesheet" href="http://web-toolkit.global.sky.com/0.4.8/stylesheets/toolkit.css">
    <link rel="stylesheet" href="./dist/css/wiki.css">
    <script src="http://assets.sky.com/js/lib/jquery-1.9.1.min.js" type="text/javascript"></script>

    <!--[if LT IE 9]>
<link rel='stylesheet' href='//assets.sky.com/css/desktop-12grid.css' media='screen' />
<![endif]-->
<meta content='width=device-width, initial-scale=1.0' name='viewport'>
<link rel='stylesheet' href='//assets.sky.com/css/responsive-12grid.css' class='skycom-responsive-css' media='screen and (min-width: 768px)' />
<!--[mobilestart]-->
<link rel='stylesheet' href='//assets.sky.com/css/mobile-12grid.css' class='skycom-mobile-css' media='screen and (max-width: 767px)' />
<!--[mobileend]-->

<link href='//assets.sky.com/images/favicon.png' rel='icon' type='image/png'>
<link href='//assets.sky.com/fonts/sky_regular.ttf' rel='prefetch'>
<link href='//assets.sky.com/fonts/sky_regular.svg' rel='prefetch'>
<link href='//assets.sky.com/fonts/sky_medium.ttf' rel='prefetch'>
<link href='//assets.sky.com/fonts/sky_medium.svg' rel='prefetch'>
<link rel='stylesheet' href='//assets.sky.com/css/css-print.css' media='print' />
<link rel='stylesheet' href='//assets.sky.com/css/app-fonts.css' />
<!--[if IE 6]>
<link rel='stylesheet' href='//assets.sky.com/css/app-ie6.css' />
<![endif]-->
<!--[if IE 7]>
<link rel='stylesheet' href='//assets.sky.com/css/app-ie7.css' />
<![endif]-->
<!--[if LT IE 9]>
<link rel='stylesheet' href='//assets.sky.com/css/app-ielt9.css' />
<![endif]-->
<!--[if IE 9]>
<link rel='stylesheet' href='//assets.sky.com/css/app-ie9.css' />
<![endif]-->
<!--[if LT IE 10]>
<link rel='stylesheet' href='//assets.sky.com/css/app-ielt10.css' />
<![endif]-->
<script id='skycom-view-type'></script>
<script id='skycom-orientation'></script>
<script>
  var globalskycom = globalskycom || {};
  globalskycom.serverHost = 'assets.sky.com';
</script>
<script src='//assets.sky.com/js/app.js'></script>
<script>
  $(function() {
    var i, len,
      messages = globalskycom.emergencyMessages;
    if(messages) {
      for(i = 0, len = messages.length; i < len; i++) {
        new globalskycom.message(messages[i]);
      }
    }
  });
</script>

    <!-- Tracking - aka: What you came here for -->
    <script type='text/javascript' src="./dist/js/tracking.js"></script>
</head>
<body>

<div class='grid-1140'>

    <div class="quick-links">
        <div class="skycom_container">
            <ul class="nav-pills alpha skycom_12">
                <li><a href="./#using-me">Using the Analytics</a></li>
                <li><a href="./#link-tracking">Link Tracking</a></li>
                <li><a href="./#custom-vars">Custom Variables</a></li>
                <li><a href="./#custom-events">Custom Events</a></li>
                <li><a href="./#manual">Manual Trigger</a></li>
                <li><a href="./#single-page-apps">Single Page Apps</a></li>
            </ul>
        </div>
    </div>
    <div class="skycom-container clearfix">
        <div class="alpha skycom-12">
            <h1 class="wiki-header">Omniture Analytics <small>v0.6.0</small></h1>

<section class="wiki-section">
    <a name="using-me"></a>
    <h2>Using the Analytics</h2>
    <p class="developer-notes">
        <a href='http://analytics.global.sky.com/0.6.0/tracking.js'>http://analytics.global.sky.com/0.6.0/tracking.js</a>
    </p>
    <a name="contributing"></a>
    <div class="sub-section">
        <h3 class="wiki-h3">Contributing</h3>
<p >
    The source code is available in a private repository on Github, along with instructions for building/running the project locally.  Please fork it from here:
    <a href="https://github.com/skyglobal/analytics/">https://github.com/skyglobal/analytics/</a>
</p>

<dl class="clearfix ">
    <dt class="skycom_4 alpha">Feature Requests</dt>
    <dd class="skycom_8">Please check <a href="https://github.com/skyglobal/analytics/issues">here</a> to see if there is already a similar request. If not, create a New
        Issue and flag it as an '<code>enhancement</code>'</dd>
    <dt class="skycom_4 alpha">Bug Reporting</dt>
    <dd class="skycom_8">Please check <a href="https://github.com/skyglobal/analytics/issues">here</a> to see if there is already a similar request. If not, create a New
        Issue and flag it as a '<code>bug</code>'</dd>
</dl>
    </div>
    <a name="getting-started"></a>
    <div class="sub-section">
        <h3 class="wiki-h3">Getting Started</h3>
<p> Once tracking has been initialised,
    <code>anchors</code>, <code>buttons</code>, <code>submits</code> and any element with <code>[data-tracking]</code> are automatically tracking.
    You Can also manually trigger tracking using JS.
</p>

<h4>Initialising</h4>
<p>The are a number of details that needs to be passed to the tracking code, which should be passed through as a single object.  Please get the applicable details for your project from <code>implementation@bskyb.com</code>.</p>
<p>The following can be added to the <code>config</code> object:</p>

<dl class="clearfix ">
    <dt class="skycom_4 alpha">site</dt>
    <dd class="skycom_8">[mandatory] --- desciption here ---</dd>
    <dt class="skycom_4 alpha">section</dt>
    <dd class="skycom_8">[mandatory] --- desciption here ---</dd>
    <dt class="skycom_4 alpha">account</dt>
    <dd class="skycom_8">[mandatory] --- desciption here ---</dd>
    <dt class="skycom_4 alpha">page</dt>
    <dd class="skycom_8">[mandatory] --- desciption here ---</dd>
    <dt class="skycom_4 alpha">headline</dt>
    <dd class="skycom_8">[optional] --- desciption here ---</dd>
    <dt class="skycom_4 alpha">contentType</dt>
    <dd class="skycom_8">[optional] --- desciption here ---</dd>
    <dt class="skycom_4 alpha">contentId</dt>
    <dd class="skycom_8">[optional] --- desciption here ---</dd>
    <dt class="skycom_4 alpha">debug</dt>
    <dd class="skycom_8">[optional] [true|false]. Turn on debug on page load to capture the page view event</dd>
    <dt class="skycom_4 alpha">customVariables</dt>
    <dd class="skycom_8">[optional] An object used to add your own tracking variable mapped to an Omniture id. <a href="#custom-vars">details here >></a></dd>
    <dt class="skycom_4 alpha">customEvents</dt>
    <dd class="skycom_8">[optional] An object used to add your own tracking event mapped to an Omniture id. <a href="#custom-events">details here >></a></dd>
</dl>

<p>Then you must tell the code to either add a pageView:
<code >    toolkit.tracking.pageView(config); </code>
</p>
<p>or to complete the setup, but without firing a pageView:
<code >    toolkit.tracking.setup(config); </code>
</p>
<h4>Debugging</h4>
<p>Outside of the config, you can easily execute the following after the page has loaded to start debugging:
    <code class="block">    toolking.tracking.debug(<i>[true|false]</i>);</code>
</p>
    </div>
</section>


<a name="link-tracking"></a>
<section class="wiki-section">
    
<h2>Link Tracking</h2>
<p>
    Pages are commonly split up in the following areas: Modules, Pods and other.
    You may also want to track Editorial-Themes or the Context along with clicked text.
</p>
<h3 class="wiki-h3">Basic tracking info</h3>
<p>By default we automatically track the <code>text</code> that is clicked along with the <code>site</code> name.  In order of priority, we track: data-tracking-label, alt, value, name, or lastly the text.
</p>
<h3 class="wiki-h3">Optional tracking Attributes</h3>
<p>
    Add the following <code>data</code> attributes to the relevant containers within your page.
    When an element is clicked, the JS will traverse up the DOM looking for these attributes.
</p>
<dl class="clearfix">
    <dt class="skycom_4 alpha">data-tracking-module</dt>
    <dd class="skycom_8">Add this to a top-level container.
        <br/>This defines a distinct horizontal band on a page.
        <br /> eg. <code>data-tracking-module=carousel</code>
    </dd>
    <dt class="skycom_4 alpha">data-tracking-pod</dt>
    <dd class="skycom_8">Add this to a mid-level container.
        <br/>This commonly defines a vertical band within the module or a segment of content.
        <br /> eg. <code>data-tracking-pod=slide2</code></dd>
    <dt class="skycom_4 alpha">data-tracking-other</dt>
    <dd class="skycom_8">Add this to a Low level container.
        <br/> This might be useful for multi-level navigation.
        <br/> eg. <code>data-tracking-other=subnav-text</code></dd>
    <dt class="skycom_4 alpha">data-tracking-theme</dt>
    <dd class="skycom_8">Add this to the element being clicked or a container.
        <br> Used to group items or related links that may be across modules.
        <br /> eg. <code>data-tracking-theme=friends-and-family</code></dd>
    <dt class="skycom_4 alpha">data-tracking-context <br>... or ... data-tracking-context-id</dt>
    <dd class="skycom_8">Add this to the element being clicked.
        <br/>Useful when multiple links have the same text, you may need more context around the link i.e. 'remote record' may need the context of what is being recorded
        <br/> eg. <code>data-tracking-context=bond-11</code> or <code>data-tracking-context-id=search-box</code></dd>
    <dt class="skycom_4 alpha">data-tracking-label</dt>
    <dd class="skycom_8">Add this to the element being clicked
        <br/>A text alternative. Useful when the text clicked may be too long or non-unique.
        <br/> eg. <code>data-tracking-label=bond-remote-record</code></dd>
    <dt class="skycom_4 alpha">data-tracking-search</dt>
    <dd class="skycom_8">Add this to the button/link that triggers the search.
        <br/>Must be used with <code>data-tracking-context-id</code>.
        <br/> eg. <code>data-tracking-search=weather data-tracking-context-id=search-box</code></dd>
    <dt class="skycom_4 alpha">data-tracking</dt>
    <dd class="skycom_8">Add this to an element you do/dont want tracked
        <br/>A way to force tracking of an element or to stop the tracking of an element.
        <br/> eg. <code>data-tracking=false</code></dd>
</dl>

<h3 class="wiki-h3" data-tracking="false">Examples</h3>
<p>Execute <code>toolkit.tracking.verify()</code> and click around below.</p>
<div class='example clearfix'>

    <div class="skycom_4 alpha">
        <a href="#inpage-link">Standard anchor link</a>
    </div>
    <div class="skycom_8">
        <code class="block">&lt;a href=&quot;http://sky.com&quot;&gt;Standard anchor link&lt;/a&gt;</code>
    </div>
    <div class="skycom_4 alpha">
        <span data-tracking >Tracking a non anchor/button/submit</span>
    </div>
    <div class="skycom_8">
        <code class="block">&lt;span data-tracking >Tracking a non anchor/button/submit&lt;/span></code>
    </div>

    <div class="skycom_4 alpha">
        <div data-tracking-module='section-1'>
            <div data-tracking-pod='pod-1' data-tracking-other='sub menu' data-tracking-theme='my theme'>
                <a href="#inpage-link"  data-tracking-context='context'>Identical text, tracked differently</a>
            </div>
            <div data-tracking-pod='pod-2'>
                <a href="#inpage-link">Identical text, tracked differently</a>
            </div>
        </div>
    </div>
    <div class="skycom_8">
        <code class="block">&lt;div data-tracking-module='section-1'&gt;
    &lt;div data-tracking-pod='pod-1' data-tracking-context='context'&gt;
        &lt;a href=&quot;#inpage-link&quot;&gt;Deep link&lt;/a&gt;
    &lt;/div&gt;
    &lt;div data-tracking-pod='pod-2'&gt;
        &lt;a href=&quot;#inpage-link&quot;&gt;Deep link&lt;/a&gt;
    &lt;/div&gt;
&lt;/div&gt;</code>

    </div>




    <div class='skycom_4 alpha'>
        <a data-tracking="false" href="#inpage-link">Untracked anchor link</a>
    </div>
    <div class="skycom_8">
        <code class="block">&lt;a data-tracking=false href=&quot;http://sky.com&quot;&gt;Untracked anchor link&lt;/a&gt;
        </code>
    </div>

    <div class='skycom_4 alpha'>
        <a class='btn primary-cta' data-tracking-label='label-text' href="http://sky.com">Std btn link with label</a>
    </div>
    <div class="skycom_8">
        <code class="block">&lt;a class='btn primary-cta' href=&quot;http://sky.com&quot;&gt;Std btn link with label&lt;/a&gt;</code>
    </div>

    <div class='skycom_4 alpha skycom_clear'>
        <button class="btn sign-post">Normal Button</button>
    </div>
    <div class="skycom_8">
        <code>
            &lt;button class=&quot;btn sign-post&quot;&gt;Normal Button&lt;/button&gt;
        </code>
    </div>

    <div class='skycom_4 alpha skycom_clear sky-form'>
        <input id="weather-location-search" type="text" placeholder="Postcode or town">
        <button class="btn" type="submit" data-tracking-search="weather" data-tracking-context-id="weather-location-search">Search</button>
    </div>
    <div class="skycom_8">
        <code class="block">&lt;input id="weather-location-search" type="text" placeholder="Postcode or town">
&lt;button class="btn" type="submit" data-tracking-search="weather" data-tracking-context-id="weather-location-search">Search&lt;/button></code>
    </div>
</div>
</section>

<a name="custom-vars"></a>
<section class="wiki-section">
    <h2>Custom Variables</h2>
<p>
    You will need variable Name and Omniture ID. These should be added to the tracking config on initialisation.
</p>
<code class="block">    var config = {
        ...
        customVariables: [
            {'myCustomVar': <i>customConfig</i>}
        ]
    };
    toolkit.tracking.pageView(config);
</code>

<p>The <code>customConfig</code> object options are</p>
<dl class="clearfix ">
    <dt class="skycom_4 alpha">var</dt>
    <dd class="skycom_8">[int] Omniture Variable Id. Needed for xxx type reporting</dd>
    <dt class="skycom_4 alpha">prop</dt>
    <dd class="skycom_8">[int] Omniture Prop Id.Needed for xxx type reporting</dd>
    <dt class="skycom_4 alpha">onPageLoad</dt>
    <dd class="skycom_8">[boolean] Set if the variable should be sent on 'pageView'</dd>
    <dt class="skycom_4 alpha">value</dt>
    <dd class="skycom_8">[string] Should be set if <code>onPageLoad</code> is set</dd>
</dl>

<p>
    To get a value to go with your variable, you must bind it to an HTML element using the attribute
    <code>data-tracking-variable</code> and setting it to your variable name.  This element also needs the attribute
    <code>data-tracking-value</code> so we know what to send to Omniture.
    If this attribute is omitted, the value of the item clicked will be tracked.
</p>

<h3 class="wiki-h3">Tracking <code>drink</code> and setting the value to a text box</h3>
<div class="skycom_4 alpha">
    <form id='text-input' class="sky-form">
        <label for='input_field'>What is your favourite drink?</label> <br>
        <input id='input_field' name='input_field' type='text' /><br>
        <button data-tracking-variable='drink' data-tracking-value=""  class='btn primary-cta'>Submit</button>
    </form>
</div>
<div class="skycom_8">
    <code class="block">&lt;label for='input_field'>What is your favourite drink?&lt;/label>
&lt;input id='input_field' name='input_field' type='text' />
&lt;button data-tracking-variable='drink' data-tracking-value="" class='btn primary-cta'>Submit&lt;/button>
&lt;script>//script to update data-tracking-value attribute
$('[data-tracking-variable=drink]').attr('data-tracking-value',$('#input_field').val());
&lt;/script></code>
</div>

<h3 class="wiki-h3 skycom-clear">Tracking <code>how_about_pina_coladas</code> and setting it to the selected radio button</h3>
<div class="skycom_4 alpha">
    <form id='radio-input' class="sky-form">
        <label>Do you like Pina Coldas?</label> <br>
        <input id='radio_yes' checked name='radio_field' type='radio' value='yes_to_pinas'/><label for='radio_yes'>Yes</label>
        <input id='radio_no' name='radio_field' type='radio' value='no_to_pinas'/><label for='radio_no'>No</label>
        <br>
        <button data-tracking-variable='how_about_pina_coladas' data-tracking-value="" class='btn primary-cta'>Submit</button>
    </form>
</div>
<div class="skycom_8">

    <code class="block">&lt;label>Do you like Pina Coldas?&lt;/label>
&lt;input id='radio_yes' name='radio_field' type='radio' value='yes_to_pinas'/>
&lt;label for='radio_yes'>Yes&lt;/label>
&lt;input id='radio_no' name='radio_field' type='radio' value='no_to_pinas'/>
&lt;label for='radio_no'>No&lt;/label>
&lt;button data-tracking-variable='how_about_pina_coladas' class='btn primary-cta'>Submit&lt;/button>
&lt;script>//script to update data-tracking-value attribute
$('[data-tracking-variable=how_about_pina_coladas]').attr(
    'data-tracking-value',
    $('input[name=radio_field]:checked').val()
);
&lt;/script></code>
</div>

<h3 class="wiki-h3 skycom-clear">Tracking <code>colour</code> and setting it to the value of the button clicked</h3>
<div class="skycom_4 alpha">
    <button id='colour-button-blue' data-tracking-variable="colour" class="btn">Blue</button>
    <button id='colour-button-secondary' data-tracking-variable="colour" class="btn secondary">Gray</button>
</div>
<div class="skycom_8">
    <code class="block">&lt;button  data-tracking-variable="colour">Blue&lt;/button>
&lt;button data-tracking-variable="colour">Gray&lt;/button></code>
</div>
<script type='text/javascript'>
    $(document).ready(function(){
        $('[data-tracking-variable=how_about_pina_coladas]').attr('data-tracking-value',$('input[name=radio_field]:checked').val());
        $('[data-tracking-variable=drink]').attr('data-tracking-value',$('#input_field').val());
        $('#input_field').on('blur', function(e){
            $('[data-tracking-variable=drink]').attr('data-tracking-value',$(this).val());
        });
        $('#radio-input input').on('click', function(e){
            $('[data-tracking-variable=how_about_pina_coladas]').attr('data-tracking-value',$(this).val());
        });
        $('#text-input button, #radio-input button').on('click', function(e){
            e.preventDefault();
        });
    });
</script>
</section>

<a name="custom-events"></a>
<section class=wiki-section>
    <h2>Custom Events</h2>
<p>
    You will need event Name and Omniture ID. These should be added to the tracking config on initialisation.
</p>

<code class="block">    var config = {
        ...
        customEvents: [
            {'myCustomEvent': <i>customConfig</i>}
        ]
    };
    toolkit.tracking.pageView(config);
</code>

<p>The <code>customConfig</code> object options are</p>
<dl class="clearfix ">
    <dt class="skycom_4 alpha">event</dt>
    <dd class="skycom_8">[int] Omniture Event Id</dd>
    <dt class="skycom_4 alpha">onPageLoad</dt>
    <dd class="skycom_8">[boolean] Set if the variable should be sent on 'pageView'</dd>
</dl>

<h3 class="wiki-h3">Triggered on link click</h3>

<div class="skycom_4 alpha">
    <a class='btn in-page-cta' href='#!' id='btn_custom_event' data-tracking-event='magic_happened'>Custom Event</a>
</div>
<div class="skycom_8">
    <code class="block">    config = {
        ...
        customEvents: [{'magic_happened': {event: 101}}]
    };    </code>
</div>

<h3 class="wiki-h3">Trigger Event onPageLoad</h3>
<p>To send an event upon page load, define the event in your sitecat config.</p>

<div class="skycom_4 alpha">
    <a class='btn in-page-cta' href='custom_page_load.html' id='btn_page_load'>Custom Page Load</a>
</div>
<div class="skycom_8">
    <code class="block">    config = {
        ...
        customEvents: [{'magic_happened': {event: 101, onPageLoad: true}}]
    };    </code>
</div>

</section>

<a name="manual"></a>
<section class=wiki-section>
    <h2>Manually Trigger Tracking</h2>
<p>
    You can trigger tracking any time in JS using the following.
    The tracking event will trigger as if the user had clicked the element themselves.
</p>
<code class="block">$('.element').trigger('toolkit.track');</code>
</section>

<a name="single-page-apps"></a>
<section class=wiki-section>
    <h2>Single Page Apps</h2>
<p>Simulate a page load event for sites that make use of ajax by calling:</p>
<code class="block">toolkit.tracking.pageView(config);</code>
<h3>Example</h3>
<a class='btn in-page-cta' href='#' id='btn_ajax_event' data-tracking="false">Ajax Event</a>
<script type='text/javascript'>
    $('body').on('click', '#btn_ajax_event', function(e){
        e.preventDefault();
        toolkit.tracking.pageView({
            site: 'mysky',
            section: 'skyglobal/analytics',
            account: 'bskybmyaccountdev',
            page: 'Analytics demo page',
            customEvents: [
                {'ajax_happened': {event: 101, onPageLoad: true}}
            ],
            customVariables: [
                {'colour': {var: 71 }},
                {'drink': {'var': 72 }},
                {'how_about_pina_coladas': {'var': 73 }}
            ]
        });
    });
</script>
</section>
<script type="text/javascript" charset="utf-8">

    //todo: explain when to use
//    headline: '',
//    contentType: '',
//    contentId: '',
    toolkit.tracking.pageView({
        site: 'mysky', //todo:mandatory. docs note this should not have sky/portal
        section: 'skyglobal/analytics', //todo:mandatory. docs note this should not start or end with /
        account: 'bskybmyaccountdev', //todo: mandatory
        page: 'Analytics demo page', //todo: mandatory
        customEvents: [
            {'magic_happened': {event: 101}}
        ],
        customVariables: [
            {'colour': {var: 71}},
            {'drink': {'var': 72}},
            {'how_about_pina_coladas': {'var': 73}},
        ]
    });
</script>
        </div>
    </div>
    <!--<script src="dist/scripts/lib/require.js" data-main='dist/scripts/wiki'></script>-->
</div>
</body>
</html>
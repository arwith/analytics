<!DOCTYPE html>
<html>
  <head>
    <title>Sky Analytics API Demo Page</title>

    <script type="text/javascript">
      // Don't do this to pull in the masthead! We're only doing it to keep this page html
      var xhReq = new XMLHttpRequest();
      xhReq.open("GET", "http://assets.sky.com/resources/mobile-ready/12/css/", false);
      xhReq.send(null);
      var serverResponse = xhReq.responseText;
      document.write(serverResponse);
    </script>

    <!-- CSS -->
    <link rel="stylesheet" href="//web-toolkit.global.sky.com/0.3.19/stylesheets/toolkit.css">
    <link rel="stylesheet" href="./css/styles.css">

    <!-- Javascript -->
    <script src="http://assets.sky.com/js/lib/jquery-1.9.1.min.js" type="text/javascript"></script>

    <!-- Tracking - aka: What you came here for -->
    <script type='text/javascript' src="../tracking.js"></script>
  </head>
  <body>

    <div class='skycom_container'>

      <h1 >Omniture Tracking</h1>


      <div class="quick-links">
          <div class="skycom_container">
              <ul class="nav-pills alpha skycom_12">
                  <li><a href="#intro">Intro</a></li>
                  <li><a href="#linkTracking">Link Tracking</a></li>
                  <li><a href="#customVars">Custom Variables</a></li>
                  <li><a href="#customEvents">Custom Events</a></li>
                  <li><a href="#manual">Manual Trigger</a></li>
                  <li><a href="#ajax">AJAX Pages</a></li>
              </ul>
          </div>
      </div>

      <a name="intro"></a>
      <section>
        <h2>Intro</h2>
        <p> Once tracking has been initialised,
            <code>anchors, buttons, submits</code> and any element with <code>[data-tracking]</code> are automatically tracking.
            You Can also manually trigger tracking using JS.
        </p>

        <h3>Initialising</h3>
        <p>Please get these details from <code>Andrew.Gerhardt@bskyb.com</code> or <code>James.Muldoon@bskyb.com</code>.
            <code class="block">
var SITECAT_CONFIG = {
    site: 'mysky',
    section: 'skyglobal/analytics',
    headline: '',
    contentType: 'skyglobal',
    contentId: '',
    account: 'bskybmyaccountdev',
    page: 'Analytics demo page'
};
toolkit['tracking'](SITECAT_CONFIG);
          </code>
        </p>
          <h3>Debugging</h3>
          <p>
              You can easily see what is being tracking by executing the following in the console:
              <code>toolking.tracking.verify();</code>
          </p>
          </section>

      <a name="linkTracking"></a>
      <section>
        <h2>Link Tracking</h2>
        <p>
          Pages are commonly split up in the following areas: Modules, Pods and other.
          You may also want to track Editorial-Themes or the Context along with clicked text.
        </p>
        <h3>Basic tracking info</h3>
          <p>By default we automatically track the <code>text</code> that is clicked along with the <code>site</code> name.  In order of priority, we track: data-tracking-label, alt, value, name, or lastly the text.
          </p>
        <h3>Optional tracking Attributes</h3>
        <p>
            Add the following <code>data</code> attributes to the relevant containers within your page.
            When an element is clicked, the JS will traverse up the DOM looking for these attributes.
        </p>
        <dl class="clearfix">
          <dt class="skycom_4 alpha"><code>data-tracking-module</code></dt>
          <dd class="skycom_8">A top-level container. a distinct horizontal band on the page.
              <br /> eg. <code>data-tracking-module=carousel</code></dd>
          <dt class="skycom_4 alpha"><code>data-tracking-pod</code></dt>
          <dd class="skycom_8">A mid-level container. Commonly a vertical band within the module or a segment of content.
              <br /> eg. <code>data-tracking-pod=slide2</code></dd>
          <dt class="skycom_4 alpha"><code>data-tracking-other</code></dt>
          <dd class="skycom_8">Low level container.  Useful for multi-level navigation.
              <br/> eg. <code>data-tracking-other=subnav-text</code></dd>
          <dt class="skycom_4 alpha"><code>data-tracking-theme</code></dt>
          <dd class="skycom_8">Used to group items or related links that may be across modules.
              <br /> eg. <code>data-tracking-theme=friends-and-family</code></dd>
          <dt class="skycom_4 alpha"><code>data-tracking-context</code> <br>... or ... <code>data-tracking-context-id</code></dt>
          <dd class="skycom_8">Useful when multiple links have the same text, you may need more context around the link i.e. 'remote record' may need the context of what is being recorded
              <br/> eg. <code>data-tracking-context=bond-11</code> or <code>data-tracking-context-id=search-box</code></dd>
          <dt class="skycom_4 alpha"><code>data-tracking-label</code></dt>
          <dd class="skycom_8">a text alternative. Useful when the text clicked may be too long or non-unique.
              <br/> eg. <code>data-tracking-label=bond-remote-record</code></dd>
          <dt class="skycom_4 alpha"><code>data-tracking-search</code></dt>
          <dd class="skycom_8">Add this to the button/link that triggers the search. Must be used with <code>data-tracking-context-id</code>.
              <br/> eg. <code>data-tracking-search=weather data-tracking-context-id=search-box</code></dd>
          <dt class="skycom_4 alpha"><code>data-tracking</code></dt>
          <dd class="skycom_8">A way to force tracking of an element or to stop tracking of an element.
              <br/> eg. <code>data-tracking=false</code></dd>
        </dl>

        <h3 data-tracking="false">Examples</h3>
        <p>Execute <code>toolkit.tracking.verify()</code> and click around below.</p>
        <div class='example clearfix'>

            <div class="skycom_4 alpha">
                <a href="#inpage-link">Standard anchor link</a>
            </div>
            <div class="skycom_8">
                <code class="block">&lt;a href=&quot;http://sky.com&quot;&gt;Standard anchor link&lt;/a&gt;
                </code>
            </div>
            <div class="skycom_4 alpha">
                <span data-tracking >Tracking a non anchor/button/submit</span>
            </div>
            <div class="skycom_8">
                <code class="block">&lt;span data-tracking >Tracking a non anchor/button/submit&lt;/span>
                </code>
            </div>

            <div class="skycom_4 alpha">
              <div data-tracking-module='section-1'>
                <div data-tracking-pod='pod-1' data-tracking-context='context'>
                    <a href="#inpage-link">Identical text, tracked differently</a>
                </div>
                <div data-tracking-pod='pod-2'>
                  <a href="#inpage-link">Identical text, tracked differently</a>
                </div>
              </div>
            </div>
            <div class="skycom_8">
                <code class="block">&lt;div data-tracking-module='section-1'&gt;
    &lt;div data-tracking-pod='pod-1' data-tracking-context='context'&gt;
        &lt;a href=&quot;#inpage-link&quot;&gt;Deep link&lt;/a&gt;
    &lt;/div&gt;
    &lt;div data-tracking-pod='pod-2'&gt;
        &lt;a href=&quot;#inpage-link&quot;&gt;Deep link&lt;/a&gt;
    &lt;/div&gt;
&lt;/div&gt;
                </code>
            </div>




          <div class='skycom_4 alpha'>
              <a data-tracking="false" href="#inpage-link">Untracked anchor link</a>
          </div>
          <div class="skycom_8">
              <code class="block">&lt;a data-tracking=false href=&quot;http://sky.com&quot;&gt;Untracked anchor link&lt;/a&gt;
              </code>
          </div>

          <div class='skycom_4 alpha'>
              <a class='btn primary-cta' data-tracking-label='label-text' href="http://sky.com">Std btn link with label</a>
          </div>
            <div class="skycom_8">
              <code class="block">&lt;a class='btn primary-cta' href=&quot;http://sky.com&quot;&gt;Std btn link with label&lt;/a&gt;</code>
          </div>

          <div class='skycom_4 alpha skycom_clear'>
              <button class="btn sign-post">Normal Button</button>
          </div>
          <div class="skycom_8">
              <code>
                  &lt;button class=&quot;btn sign-post&quot;&gt;Normal Button&lt;/button&gt;
              </code>
          </div>

          <div class='skycom_4 alpha skycom_clear sky-form'>
              <input id="weather-location-search" type="text" placeholder="Postcode or town">
              <button class="btn" type="submit" data-tracking-search="weather" data-tracking-context-id="weather-location-search">Search</button>
          </div>
          <div class="skycom_8">
              <code>
                  &lt;input id="weather-location-search" type="text" placeholder="Postcode or town">
                  &lt;button class="btn" type="submit" data-tracking-search="weather" data-tracking-context-id="weather-location-search">Search&lt;/button>
              </code>
          </div>
        </div>
      </section>



      <a name="customVars"></a>
      <section>
          <h2>Custom Variables</h2>
          <p>
              You will need variable Name and ID which should be set when initialising tracking.
              This name will then be used within the HTML as another <code>data</code> attribute set on the element being clicked.
          </p>
          <h3>Mandatory Setup</h3>
          <dl>
              <dt class="skycom_4 alpha"><code>data-tracking-custom-variable</code></dt>
              <dd class="skycom_8">Useful for capturing values determined by user interactions with the page.
                  <br />eg. <code>data-tracking-custom-variable=myCustomVar</code>
              </dd>
          </dl>
          <code class="block">
var SITECAT_CONFIG = {
  ...
  customVariables: [
      {'myCustomVar': {var: 71}}
  ]
};
toolkit['tracking'](SITECAT_CONFIG);
          </code>

          <h3>Optional Setup</h3>
          <p>
              You may want to track text entered by the user, or the value of an option selected by the user.
              The can be done by setting the <code>valueSelector</code> when initialising the tracking config.
          </p>

          <code class="block">
var SITECAT_CONFIG = {
    ...
    customVariables: [
        {'myCustomVar':
              { var: 71,
                valueSelector: '#radio-input input[name=radio_field]:checked'
              }
        }
    ]
};
toolkit['tracking'](SITECAT_CONFIG);
          </code>

          <h3>Examples</h3>
          <div class="skycom_4 alpha">
              <form id='text-input'>
                  <label for='input_field'>What is your favourite drink?</label> <br>
                  <input id='input_field' name='input_field' type='text' /><br>
                  <button data-tracking-custom-variable='drink' class='btn primary-cta'>Submit</button>
              </form>
          </div>
          <div class="skycom_8">
              <code class="block">
&lt;label for='input_field'>What is your favourite drink?&lt;/label>
&lt;input id='input_field' name='input_field' type='text' />
&lt;button data-tracking-custom-variable='drink' class='btn primary-cta'>Submit&lt;/button>
            </code>
          </div>

          <div class="skycom_4 alpha">
              <form id='radio-input'>
                  <label>Do you like Pina Coldas?</label> <br>
                  <input id='radio_yes' name='radio_field' type='radio' value='yes_to_pinas'/><label for='radio_yes'>Yes</label>
                  <input id='radio_no' name='radio_field' type='radio' value='no_to_pinas'/><label for='radio_no'>No</label>
                  <br>
                  <button data-tracking-custom-variable='how_about_pina_coladas' class='btn primary-cta'>Submit</button>
              </form>
          </div>
          <div class="skycom_8">
              <code class="block">
&lt;label>Do you like Pina Coldas?&lt;/label>
&lt;input id='radio_yes' name='radio_field' type='radio' value='yes_to_pinas'/>&lt;label for='radio_yes'>Yes&lt;/label>
&lt;input id='radio_no' name='radio_field' type='radio' value='no_to_pinas'/>&lt;label for='radio_no'>No&lt;/label>
&lt;button data-tracking-custom-variable='how_about_pina_coladas' class='btn primary-cta'>Submit&lt;/button>
              </code>
          </div>

          <div class="skycom_4 alpha">
              <button id='colour-button-blue' data-tracking-custom-variable="colour" class="btn">Blue</button>
          </div>
          <div class="skycom_8">
              <code class="block">
&lt;button id='colour-button-blue' data-tracking-custom-variable="colour">Blue&lt;/button>
              </code>
          </div>
          <script type='text/javascript'>
              $(document).ready(function(){
                  $('#text-input button').on('click', function(e){
                      e.preventDefault();
                  });

                  $('#radio-input button').on('click', function(e){
                      e.preventDefault();
                  });
              });
          </script>
      </section>


      <a name="customEvents"></a>
      <section>
        <h2>Custom Tracking Events</h2>
        <p>You will need event Name and ID which should be set when initialising tracking.</p>

        <h3>Trigger Event onPageLoad</h3>
        <p>To send an event upon page load, define the event in your sitecat config.</p>

        <div class="skycom_4 alpha">
            <a class='btn in-page-cta' href='custom_page_load.html' id='btn_page_load'>Custom Page Load</a>
        </div>
        <div class="skycom_8">
            <code class="block">
SITECAT_CONFIG = {
    ...
    customEvents: [{'magic_happened': {event: 101, onPageLoad: true}}]
};
            </code>
        </div>
      </section>

      <a name="manual"></a>
      <section>
        <h2>Manually Trigger Tracking</h2>
        <p>
            You can trigger tracking any time in JS using the following.
            The tracking event will trigger as if the user had clicked the element themselves.
        </p>
        <code class="block">$('.element').trigger('toolkit.track');</code>
      </section>

      <a name="ajax"></a>
      <section>
        <h2>Ajax sites or pages</h2>
        <p>Simulate a page load event for sites that make use of ajax by calling:</p>
          <code class="block">toolkit.tracking.resetPageConfig(SITECAT_CONFIG);</code>
        <script type='text/javascript'>
          $(document).ready(function(){
            $('#btn_ajax_event').on('click', function(e){
              e.preventDefault();
              $.extend(SITECAT_CONFIG, {customEvents: [{'ajax_happened': {event: 101, onPageLoad: true}}]});
              toolkit.tracking.resetPageConfig(SITECAT_CONFIG);
            });
          });
        </script>
        <h3>Example</h3>
          <a class='btn in-page-cta' href='#' id='btn_ajax_event' data-tracking="false">Ajax Event</a>
      </section>

    </div>
    <script type="text/javascript" charset="utf-8">
      SITECAT_CONFIG = {
        site: 'mysky',
        section: 'skyglobal/analytics',
        headline: '',
        contentType: 'skyglobal',
        contentId: '',
        account: 'bskybmyaccountdev',
        page: 'Analytics demo page',
        customEvents: [
          //{'drink': {var: 72, valueSelector: '#text-input input'}},
          //{'how_about_pinos': {var: 73, valueSelector: '#radio-input input[name=radio_field]:checked'}}
        ],
        customVariables: [
          {'colour': {var: 71}},
          {'drink': {'var': 72, valueSelector: '#text-input input'}},
          {'how_about_pina_coladas': {'var': 73, valueSelector: '#radio-input input[name=radio_field]:checked'}},
        ]
      };

      toolkit['tracking'](SITECAT_CONFIG);
    </script>
  </body>
</html>
